
## Objectives

Upon completion of this course, you will be able to:

- Define a control system and its functions for managing the elements of an AV system
- Identify the various components and software applications that comprise a control system
- Define the different control methods that provide signal communication between devices
- Define the process of how control systems are designed and commissioned
## What is a Control System? 

Typically, an AV control system includes a control processor and user interfaces, such as a mobile app, touch panel or button panel. Extron control systems are aimed at transforming complex AV systems into simpler, more powerful solutions. An Extron control system can expand to support any number of input and output devices while managing the performance of the AV System for the user.
## AV Control Functions

Automation is the goal of any control system. Control systems minimize the distractions of technology and help users focus. With the press of a single button, a control system can perform multiple operations on behalf of it's user. The following are common AV system tasks:

- Power devices on and off
- Turn lights on or off
- Set volumes
- Adjust the thermostat
- Device status and system feedback
- Record functions
- Raise and lower a projector screen
- Monitor projector lamp hours
- Trigger alerts
- Monitor occupancy status
- Video and audio conferencing
## AV Control and Network Integration

With the adoption and standardization of Informaton Technology - IT in the AV industry, the products and devices have become increasingly network-friendly. THis integration of network communication devices delivers several advances in AV control:

- A centrally managed and secure system.
- AV control and distribution across long distances
- Dedicated AV LAN or Local Area Network functions included with control processors. 
- AV over IP solutions with streaming capabilities
- Extension of a source signal and control capabilities with the use of encoders and decoders
- System scalability, reliability, flexibility and expansion
# Parts of a Control System

## User Controls

A well-defined Scope of Work - SOW is critical to the overall success of a control system design. Driven by devices that require control and the needs of the user, the specified AV control system components will include a user interface such as a touchpanel or button panel, controller or control processor, and the communication methods.
## The User

Users include a range of operators who interact with, invest in, technically support, and benefit from a control system. All have a vested interest in the successful deployment of a functional control system. When referring to users, all of the following may apply:

- Presenters, instructors and Students
- Researchers and Medical Professionals
- Corporate and Office Executives
- AV and IT Technical Staff
## User Interfaces

The control system interface often serves as the primary point of contact between the user and AV technology. To be successful, the user interface must be intuitive and responsive to the users' needs. When the user looks at the interface, it should be obvious what they can do.

User interfaces range from a traditional touchscreen or button panel to a variety of other devices and methods for interacting and operating a control system, including smartphones and tablets.
### Button Panels

***Button Panels*** are tactile interfaces that provide simplified control of AV technology in a space.

The [Extron MediaLink Plus Controllers](https://www.extron.com/product/prodtype80.aspx?s=3) (MLC Plus) are easy-to-use controllers with button interfaces. These controllers are designed for handling simple AV functions using a standard Ethernet network.

[Extron eBUS](https://www.extron.com/product/prodtype86.aspx?s=3) button panels are fully-customizable control interfaces for use with Extron IPCP Pro control processors. eBUS technology is based on a unique digital bus architecture that integrates with an Extron Pro series control system allowing for system expansion, greater design options, and future upgrades. 
### Touchpanels

As the complexity of system requirements and number of devices increases, a more flexible and high-customizable user interface will become necessary to ensure intuitive system control. **Touchpanels** provide the touchscreen interfaces to facilitate interactive control of AV devices. 

[Extron TouchLink Pro - TLP](https://www.extron.com/product/prodtype81.aspx?s=3)  touchpanels with Pro Series control processors are ideal for applications that require more functionality. Like most components in the AV system, the size of a touchpanel is driven by functionality, location and aesthetics. Touch Link Pro touchpanels come in a variety of sizes and mounting options, including wall, lectern and tabletop. 
### Mobile Devices

The control system interface often serves as the primary point of contact between the user and AV technology. To be successful, the user interface must be intuitive and responsive to the user's needs. When the user looks at the interface, it should be obvious what they can do.

User interfaces range from a traditional touchscreen or button panel to a variety of other devices and methods for interacting and operating a control system, including smartphones and tablets. 

In today's world, controlling room AV from a mobile device is easily achieved with the right technology. Extron Control is an easy-to-use AV control system app that gives users complete access to Extron control systems directly from Apple iOS, Android Devices or Web Browsers.

[Extron LinkLicense](https://www.extron.com/product/linklicense) for User Interfaces is an easy way for mobile devices or computers to be used as primary control interfaces in an Extron Pro Series control system. When combined with an Extron IPCP control processor, and the Extron Control APP, room control becomes achievable by allowing third-party touchscreens, such as Apple iOS or Android devices, to be used as the point of control. 
## Sensors

Motion, occupancy, lighting and door-trigger sensors can trigger an event without direct user interaction. It's becoming common for occupancy sensors to detect motion, where the presence of a person can automatically power up the system, turn on the lights, and control the temperature. If the space is vacant or when motion is no longer detected after a certain period of inactivity, these functions can automatically shut off or return to a pre-determined state. 

The [Extron Occupancy Sensors](https://www.extron.com/product/ocs100) provide ceiling and wall-mount options for wide coverage areas. These integrated detection sensors  automatically and continuously monitor the environment and can adjust timer and sensitivity settings.
## Control Processors

Unless the user interface includes a standalone controller, like the [MediaLink Plus Controller – MLC](https://www.extron.com/product/prodtype80.aspx?s=3), it must include a Control Processor, the brains of the control system. 

AV control processors carry out instructions defined by the configuration or programming software. The control processor facilitates the delivery of commands and the recieiving of feedback from AV devices. 
### Extron Control Processors

**Extron Pro Series Control Processors** are designed to work with TouchLink Pro touchpanels for AV system and room control. These control processors support a variety of communication methods to manage, monitor, and control AV devices using a standard Ethernet network. A secure, dedicated AV LAN port enables local control of AV devices and allows them to be isolated from the corporate network. This allows displays, switchers, source devices, screen controls, and lighting systems to be networked together for centralized management and operation by the control system.

- [IPCP Pro xi Series](https://www.extron.com/IPCP-Pro-xi-Control-Processors/prodtype-99) – High performance control processors with more memory and enhanced processing power to deliver increased upload speeds and faster runtime performance. These processors support advanced security standards and Gigabit Ethernet to ensure compatibility with multiple TouchLink Pro touchpanels and Network Button Panels over a standard network.
    
- [IPCP Pro Series](https://www.extron.com/product/listbytype.aspx?subtype=599) – Control processors designed to work with TouchLink Pro touchpanels and eBUS button panels as the control system for multiple devices and signal types. Several Extron switcher models have built-in control processors, such as the IN1608 xi, and DTP CrossPoint Series.
    
- [IPL Pro Series](https://www.extron.com/product/listbytype.aspx?subtype=598) – Control processors designed to work with TouchLink Pro touchpanels for stand-alone room control or use as secondary control processors for more complex systems. These processors enable almost any AV device to be controlled, monitored, and accessed from a Local Area Network, Wide Area Network, or the Internet.
## Software Utilities

All control system hardware includes **Firmware** which dictates the performance and behavior of the product. When technology changes and improves, a software utility is used to update the firmware and to ensure product compatibility with new devices and new software releases. 

Many Extron products include *internal web pages* for upgrading firmware, or software applications that can update multiple devices at once.

- The [Product Configuration Software - PCS](https://www.extron.com/product/software.aspx?id=pcscs) combines the ability to configure certain products, while also being able to update the device.
- The [Firmware Loader](https://www.extron.com/product/software.aspx?id=fwloader) utility is also an easy way to load firmware to devices connected via USB, serial RS-232, or Local Area Network.
- The [Toolbelt](https://www.extron.com/product/software.aspx?id=toolbelt) utility is a stand-alone application created for the management and troubleshooting of Pro Series control systems. This utility allows users to easily change device network settings, add email servers, upload firmware, remotely reboot Pro Series control products, troubleshoot, and more from a single application.
## Extron Control Software

Extron provides a full-featured software suite for Pro Series Control systems that is designed to maximize the potential of each device, and their ability to work together. 
### GUI Designer

Extron [GUI Designer](https://www.extron.com/product/software.aspx?id=guidesigner) is used to design, create and maintain Touch Link Pro user interfaces. It begins with ready to use design templates and resource kits. GUI Designer also provides the option to build a layout starting from scratch. The design elements are fully customizable where most AV system applications are already in place for input sources, display control and environmental settings.
### GC Plus and Pro

Extron [Global Configurator](https://www.extron.com/product/software.aspx?id=gcpro) is a powerful configuration software tool designed to be used exclusively with Extron Pro Series Control products. There are two modes:

- **Global Configurator Plus -** **GC Plus** is ideal for smaller applications requiring one control processor and one control interface.  
- **Global Configurator Professional** **- GC Pro** is suited for applications requiring multiple control processors, enhanced functionality, and advanced configuration.

Access to Global Configurator Professional requires **ECP Certification**. To ensure compatibility between the control system and third-party devices, Extron provides an enhanced class of device drivers to be used with GC Plus and Pro for greater AV system performance and capabilities.
### Global Scripter

In configuration, how a device is controlled, although flexible, is pre-defined. With AV programming, system functionality is defined and written by a developer. 

[Global Scripter](https://www.extron.com/product/software.aspx?id=globalscripter) is Extron's Integrated Development Environment that harnesses the dynamic power and intuitive nature of the Python programming language. The open source nature of Python allows for readily available elements to be incorporated into programs, speeding up development and lowering costs. Global Scripter includes an Extron-exclusive Python library **ControlScript**, which is designed to incorporate functions used in AV control system projects, as well as helpful documentation, reference material, and sample code. 

Extron offers an extensive catalog of modules to speed up programming for Pro Series control systems. Device modules are time-saving, reusable program files that include all the commands necessary for integrating a device into a Pro Series control system. In addition, helper modules are available with common AV operations and logic and can be used directly in your Global Scripter programs, or as examples when creating your own modules.
## Resource Management

[GlobalViewer Enterprise – GVE](https://www.extron.com/product/software.aspx?id=globalviewerentprt) is a server-based software that simplifies AV system resource management with intuitive control for hundreds of common AV tasks. All in one view, the Help Desk allows for easy navigation between rooms, management of each system with multiple tools, remote interaction with Extron control products, and system notifications.

AV equipment can be proactively monitored with status based on locations or device types. Global schedules can be defined to control power up or power down of devices, lock front panels of multiple controllers, and send reminders for maintenance and support. Reporting tools provide devices, and room usage trends to help improve equipment standardization across rooms, identify energy usage forecasts, and maintain inventory lists.

Whether working with 5 or 5000 rooms, GVE provides a powerful, flexible way to manage, monitor and control nearly any device over a standard network. 
# Control Communication

## Device Functions

There are several control methods for AV devices, each offering unique characteristics to make them suitable for the application. The control communication signals can be sent over a hardwired cabling infrastructure or wirelessly using a Wireless Access Point - WAP or the facility's existing wireless network.

With a variety of AV devices and manufacturers, how they function and how they are controlled can often be very different. Some devices, like laptops, are not easily automated as part of a control system, yet they appear regularly as sources. Some components within a system are only capable of being controlled by their manufacturer-specific hardware and software. 
## Device Control

Thankfully, there are control friendly AV devices that have well-documented protocols, procedures, and commands, making it easier to build a fully functioning system. Once the required equipment has been determined within the scope of the AV system, the next part is determining the methods to control them, which is dependent on the intended operations of each device.

In many cases, a device has only one primary method of control. However, there are many ways of getting those signals from the control processor to the device being controlled. Understanding the differences between various control methods helps to provide a simple, more reliable system.
## Serial Control

Serial interfaces are generally used for sending point-to-point command signals bidirectionally between the controller or control processor and the device, such as projectors, displays, media players, VTC codecs, cameras, matrix switchers, DSPs and lighting controls. The three main serial interfaces are RS-232, RS-422 and RS-485.

**RS-232** is one of the most common types of serial interfaces. It was the standard communication in the computer industry to connect a mouse, printer or modem, before USB came along. With a maximum distance of 50 feet (15 meters), the most common cable termination is a DB-9 connector, but can range from DB-25, mini-DIN, or captive screw terminals.

**RS-422** is an improved version of RS-232, by using twisted pair cable to reduce noise, and signal balancing to transmit data for longer distance with faster data rates. Up to 10 Mbps at 50 feet (15 meters) or 100 Kbps at 4000 feet (1200 meters).

**RS-485** supports similar data rates as RS-422 but allows up to 32 devices to communicate through the same data line. Any of the device on an RS-485 bus can communicate with others on the data line without going through the master device.
## Infrared

**Infrared - IR** control is most commonly seen when controlling AV devices using an IR remote. This wireless one way interface is designed to control a single device, not an entire AV system. The AV control system simplifies the user experience by providing a single point of control rather than requiring the user to use multiple handheld IR remotes.

Wired to the IR port of the AV controller, an IR emitter, attached using double-stick tape or silicon adhesive, will transmit a control signal to the IR receiver on the front of an AV device. IR emitters can generally run 100 feet (33 meters) for devices such as Blu-ray players, VTC codecs, switchers, cameras, displays, and projectors.

Extron [IR Learner Pro](https://www.extron.com/product/software.aspx?id=irlearnertmpro) is a software utility for capturing infrared codes from IR remotes to create or modify custom drivers for controlling IR devices. This IR application is designed for use with Extron Pro Series control processors that feature built-in IR capture ports.
## Ethernet

If AV devices are accessible over the network, they can be located nearly anywhere and still communicate. Bidirectional control commands can be sent between the controller or control processor and the device over and **Ethernet** network. 

However, communication relies on the setup, configuration, and infrastructure of the network to control devices such as projectors, VTC codecs, matrix switchers, control processors, and controllers. 

**Power over Ethernet**: carries electrical power and data over standard Category cabling. PoE devices are typically smaller Ethernet appliances that do not consume as much power, such as several Extron touchpanels that feature PoE capability. PoE+ equipment provides more power and increased electrical current capability.
## Relays and Contact Closures

In control systems, **Relays** and **Contact Closures** are a very simple and effective means of control, that do not provide any direct feedback. A device that can be controlled using contact closures, like screens, drapes, shades, and lifts, will be wired to the relays of a controller or control processor. The low voltage relay creates a contact closure. 

Relays and contact closures use two conductor wires; signal and ground. If the contact closures on a controlled device share a common ground, then the relays on the control processor will need to share a common ground. Since relays and contact closures do not pass data, the wire pairs do NOT need to be twisted or shielded.
## Digital Inputs and Outputs

Digital I/Os are very similar to relays and contact closures in regard to completing a small voltage circuit from devices to drive feedback for the control system.

**Digital Inputs** monitor the condition of a device by detecting either a high voltage or low voltage. Depending on it's condition, the device can be programmed to perform certain functions. For example, the occupancy of a conference room can be monitored. If someone enters the room, the digital input senses a change in state, and can be programmed to send commands to power up the AV system and turn on the lights.

**Digital Outputs** are used to indicate the status of a device. The circuit opens or closes based on the condition, and then drives an indicator light signifying that the device is in use.
## Analog Inputs

**Analog Inputs** also provide feedback by way of contact closure. The circuit is continuously measuring the voltage of the device (sensor) and can trigger an action at any given level. For example, analog inputs can be used to monitor the temperature sensor in an AV rack, and activate an external fan if the voltage exceeds a predefined level. 
## Power Control

Intelligent power management solutions allow operations and facility managers as well as IT administrators to use their energy resources more efficiently. Low voltage and high voltage power controllers provide easy power management to AV systems.

Many Extron controllers and control processors ae equipped with relays capable of making and breaking circuits of up to 24 V and 1-amp rating. For higher power circuits, Extron offers power controllers from within our IP Link Pro category. These power controllers offer centralized management of AC outlets rated for 100-240 VAC, 50/60 Hz operation, and can be configured or programmed to send out email notifications as scheduled on/off events are performed.

When these controllers restart following an outage, outlets are powered up sequentially with a user-configurable delay between each one. The internal memory of these units will ensure that only those devices that we on before the outage will be restarted. 
## CEC

**Consumer Electronics Control - CEC** is a function of HDMI that allows one AV device to control another if they are connected via HDMI cables. For example, the power on/off commands used on the remote control for a display can also control the functions on a set-top box or media player.
# Designing a Control System

## Meeting Expectations

Proper control system design is a balancing act. System Designers must evaluate the goals and needs of the client and weigh them against several demands, budgetary constraints, etc. Many clients have ambitious expectations and leave it up to the designer to help bring their vision in line with their budget. 

It is important to work with the client up-front to determine their goals and manage their expectation. Examining the control needs at the beginning of the project helps to choose system devices that meet the user and installation requirements in order to achieve success when all is complete. 
## Budget Demands

Low budget AV projects will require compromise in expectations by the client. The importance of deploying the most cost-effective solution should outweigh the system limitations. To develop a value-based solution, the money allocated for the project needs to be prioritized based on AV requirements, necessitates, and desired functionality. 
## The Best Design

The **Best Design** scenario is of the highest quality, most aesthetically pleasing, and integrates complete robust functionality. This type of project addresses all the client's needs and provides the best solution regardless of the related cost. 
## Aesthetic Demands

Occasionally, clients will focus primarily on the aesthetics of the design. While the functional demands are still a concern, the client may want the visible components and the user interfaces to seamlessly blend with the environment or to have a particularly "high-tech" feel. A company may want a larger more feature-rich touchpanel in their boardroom as opposed to a smaller touchpanel or button panel, despite the budgetary savings.
## Reliability Standards

Some projects involving critical operations, such as those for the military and Network Operations Centers - NOCs, place heavy demands on the serviceability and reliability of the system. 

If the systems fail for whatever reason, they need to be brought back online with minimal effort in the shortest time possible. Typically, these clients understand that these systems are more expensive and budget accordingly. 
## Control Design System Process

When designing a control system, small or large, it's important to weigh the needs and desires of those who will be using it and the intended purpose. The following steps should be considered throughout the design process:

- **Needs**: The purpose of the AV control system, and readiness dates
- **Infrastructure**: The physical topology, device location, and cabling specifications
- **Security**: System access, password integrity, availability, as well as backup and restore measures
- **Maintenance**: Availability of equipment, software and firmware updates. 
- **Implementation**: Timelines, schedules, training and documentation
- **Expansion**: Planning of infrastructure, ports, cabling, etc.
## The AV Project Timeline

This control project timeline presents a best-case scenario for a well-organized AV installation. It proposes a systematic, logical workflow that integrators and project managers can reference during a project, or, ideally prior to a project's start. 
### Scope of Work

The **Scope of Work** (SOW) defines every aspect for the project. These basic control-related questions need to be addressed:

- What are the customer’s expectations?
- How much control is required – control system or device remotes?
- What level of control is required to meet the customer’s expectations – source selection, device control, remote asset management?
- How does the customer want to interface with the system – button panel, touchpanel, iOS or Android devices?
- Where do the user interfaces need to be located – table, wall, network?
- What are the client's expectations for training and software deliverables?
### Specification

Care must be taken in the specification of the equipment with regard to control. Selection of consumer or "prosumer" equipment may look good for the budget but may disappoint in the long term or generally underperform when it comes to system operation.

Each component needs to be evaluated at the same time of specification to see how it can be controlled and whether its functions are capable of being controlled remotely. At this stage, the AV system devices can be inventoried to determine how many serial ports, IR ports, Relays, Digital I/Os, and IP connections are required. The appropriate control processor, peripherals, and equipment can be selected and specified on this assessment.
### Network Communication

Once the components of the control system have been identified, it is time to evaluate the network needs of the client and the overall control system. The IT organization should be part of this process to assist the AV integrator with the following:

- Formulate a network integration plan for the AV system.
- Identify the security requirements for devices
- Evaluate any specialized deployment requirements
- Determine the physical topology, device location, and cabling specifications
### GUI Development

During the scope of work phase, sample touchpanels can aid the client in visualizting how the control system will look and function. This also helps determine if the client wants to use an existing template with some modifications to include their logo and corporate colors, or a fully-customized design to fit their needs and company branding.

Before GUI development, map out the required functionality of the system to develop the GUI accordingly, remembering to "Keep it Simple".
### Configuration/Programming

Ideally, the time and effort placed on the front end of the project will pay dividends during the configuration and programming phase of the project. Typically, line diagrams for the audio, video, control and networking components of the system will assist as well.

System components should be tested throughout the configuration or programming process. It's best to avoid testing an entire system for the first time on-site. Developing a dry lab testing process is suggested to simulate the system prior to taking it to the client.
### Installation

Coordination between salespersons, engineers, control system developers, and installers must occur throughout the lifecycle of an AV project. Successful projects require a team approach to meeting the expectations of the customer.

Dependent on networking requirements, installers will interact with IT professionals. The installation crews will need to be trained on how to set up and address the AV equipment, as well as the control system hardware. 
### Commissioning

The commissioning phase of the project varies from project to project. Ideally, there is an internal commissioning, where the AV installers and the control system designers coordinate to test the functionality of the AV system. Both hardware and software experts should work hand-in-hand to identify and solve any system issues.

Training should be provided for the client on how to use their newly acquired AV system. It will oftentimes require the salesperson or the project manager that will set up the training, as they likely will have the best relationship with the client.
### Sign Off

The ultimate goal of the project is to present the system to the client for final training and sign-off. Final versions of the designs, software configurations, and program files should be delivered to the client along with the system documentation in accordance with the original contract agreement. 

Sign-off should be documented in writing to avoid future misunderstandings, and a procedure should be put in place for the reporting of any bugs and for the warranty of the hardware and software of the AV system.
### Extron Support

**Proposal, Specification, IT Communication** – Extron Engineers help customers choose the right products and provide system design drawings for their applications. Also, Extron Engineers help IT departments develop a game plan for how the AV devices in the Ethernet network will interact with the corporate network.  
  
**GUI Development, Configuration/Programming** – In addition to the Extron GUI Resources Web page, GUI reference guides, and TouchLink themes, Extron also offers a GUI Modification and Customization Service, which helps customers develop interfaces that balance function, style, and ease-of-use. For configuration help, Extron Engineers are standing by, and can even remotely access your computer to work directly with you on projects.  
  
**Installation, Commissioning, Sign Off** – Installers call from the job site for help with AV system installation, and Extron Engineers review the system needs and provide guidance for optimal performance of the AV and Control System. Extron also provides commissioning services for some software products, which includes system evaluation and diagnostics, installation, setup and configuration, testing and system documentation.

