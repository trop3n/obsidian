# Overview

In recent years, a proliferation of USB technology in AV applications has created a need for professional-grade devices to support USB connectivity, switching, expansion, and portability. With all the benefits and uses for USB cables and devices, they have become one of the more popular connectivity options. However, there are a host of unique challenges for the AV system designed and integrator to consider with USB.

This course will examine the basics of USB and how the Extron line of USB products are designed to solve these challenges with dependable, professional-grade solutions.

## Objectives

Upon completion of this course, you will be able to:

- Identify the main components of a USB system and their advantages for connectivity
- Understand the USB specifications and how their updates have improved performance
- Recognize the different interface connectors and their capabilities
- Understand the convenience of USB supplying power for devices
- Identify the initialization process when USB devices are connected
- Describe the data transfer and communication between USB devices
- Understand how the tiered star topology interconnects USB devices
- Identify the various USB connectivity solutions for seamless AV integration

## What is USB? 

**Universal Serial Bus** - USB is a wired interface for connecting peripheral devices to a host controller, such as a computer or laptop. 

USB was originally developed in the mid-1990's to be a widely used cable, interface connector, and bidirectional communications protocol. The aim was to standardize on a simpler connection method that increased data transfer and provided power.

As USB started replacing serial, parallel, and PS/2 ports, its technology rapidly advanced to support much more than basic mouse, keyboard and printer functions.

The increased bandwidth and performance capabilities allow USB to deliver greater audio, video and data storage in many different applications. 

## Advantages of USB Technology

USB interfaces are widely used as an effective means of providing connectivity, offering many significant conveniences and advantages.

- Simple - a single interface between a computer and a peripheral device.
- Plug and Play - Automatically recognizes, configures and loads appropriate drivers.
- Hot-Swappable - Devices can be exchanged without rebooting the computer.
- Performance - Supports data transfer speeds for a mouse and keyboard, up to Ulra-HD 4K content
- Power - A power supply and charging source for cell phones, tablets, laptop,s and workstations.

## USB System Components

The basic USB system consists of the following main components:

- **Host**: Typically a computer with downstream USB ports that initiates communication with attached peripheral devices.
- **Peripheral**: Devices that communicate with the upstream host. These comprise of storage drives, cameras, printers, scanners, webcams, and Human Interface Devices - HIDs such as keyboards and mice.
- **Bus**: A connector or set of wires within a computer or device that provides data transport and communication.
- **Hub**: Expands the number of USB ports and allows the host to communicate with multiple peripheral devices. Hubs may be stand alone or built-in to a device, such as a computer monitor or keyboard.
- **Cable**: Interconnects peripheral devices, hosts and hubs.

Peripheral devices and hubs draw power from the host on their upstream port. Self-powered devices are powered locally from an AC outlet.

## USB Communication 

The host computer contains hardware and software functions for communicating with USB devices. Up to 127 devices may be connected to a *single host controller*.

- **USB Hardware Functions**
	- Performs as the Host Controller Function
	- Detects the attachment and removal of devices
	- Monitors device status and activity
	- Manages data flow between the host and devices
	- Provides power to attached devices
- **USB Software Devices**
	- Handles device data communication
	- Monitors device inventory and configuration
	- Loads appropriate device drivers
	- Controls data transfer between software and hardware
	- Manages bus power and bandwidth

## USB Device Functions

Below are common peripheral device functions for AV systems:
- **HID**: Keyboard, mouse, joystick connected to computers or laptops
- **Audio**: Speaker, microphone, sound card, MIDI, TV
- **Video**: Webcam, digital cameras, TV
- **Network Communication**: Ethernet, Wi-Fi, Bluetooth, RS232
- **Storage**: Flash/thumb drive, external drive, digital audio player
- **Power**: Cell phones, tablets, laptops and workstations

USB Peripheral devices may operate with a single logical function or several. For example, a USB webcam may transport video while also recording audio with a built-in microphone.

# Improvements for USB

## Version History

Over the years, USB Specifications have been updated to improve performance.

- **USB 1.0** – Low Speed (1.5 Mbps)
- **USB 1.1** - Full Speed (12 Mbps)
- **USB 2.0** – High Speed (480 Mbps)
- **USB 3.X** – SuperSpeed (5 Gbps)
    - USB 3.1 Gen 1 – SuperSpeed (5 Gbps)
    - USB 3.1 Gen 2 – SuperSpeed+ (10 Gbps)
    - USB 3.2 Gen 1x2 – SuperSpeed+ (10 Gbps)
    - USB 3.2 Gen 2x2 – SuperSpeed+ (20 Gbps)
- **USB4** – Thunderbolt 3 technology (40 Gbps)

|**Specification**|**Performance**|**Max Speed**|**Uses**|**Attributes**|
|---|---|---|---|---|
|USB 1.0|Low Speed|1.5 Mbps|Keyboard, Mouse|Easy to use, connect/disconnect|
|USB 1.1|Full Speed|12 Mbps|Audio, Microphone|Easy to use, connect/disconnect|
|USB 2.0|High Speed|480 Mbps|Video, Storage, Imaging, Power|Easy to use, connect/disconnect|
|USB 3.0|SuperSpeed|5 Gbps|Video, Storage, Imaging, Power|Referred to as USB 5Gbps|
|USB 3.1|SuperSpeed+|10 Gbps|Video, Storage, Imaging, Power|Referred to as USB 10Gbps|
|USB 3.2|SuperSpeed+|20 Gbps|Video, Storage, Imaging, Power|Two-lane operation of 10 Gbps doubles to 20 Gbps data rate. Referred to as USB 20Gbps|
|USB4|Thunderbolt 3|40 Gbps|Video, Storage, Imaging, Power|Two-lane operation of 20 Gbps doubles to 40 Gbps data rate. Referred to as USB 40Gbps|
## Cable Structure

USB cables provide connection between devices, such as a smartphone and a computer. For USB 1.0 and USB 2.0, the cable contains the following wires:

- Power (+5V)
- Ground (GND)
- Data +
- Data -

To create the SuperSpeed bus, USB 3.0 cables added two twisted pairs for duplex communication on two signal lines. With more efficient encoding added, USB 3.1 doubled the bus speed to create SuperSpeed+

USB 3.2 preserves the USB 3.1 SuperSpeed and SuperSpeed+ data modes and introduced two additional SuperSpeed_ transfer modes as two-lane transfer channels.

## Interface Connectors

USB cables are designed to ensure correct connections are always made. By having different connectors on the host and device, it is impossible to connect two hosts or two peripherals together. The connector attached to the cable is called the **plug**, and the connector mounted on the host or hub is called a receptacle, or **socket**. 

As USB technology has developed or correspond with the increase in data transfer speeds, so too have the requirements for smaller connectors. Consequently, there are several USB connector types.

### Type-A

The **USB Type-A** connector is a standard, universal connector found on most computers and USB devices. The flat, rectangular interface supplies a downstream connection from the host or hub to keyboards, mice, flash drives, and similar devices.

### Type-B

The **USB Type-B** connector is an upstream interface that is used to receive data or power on peripheral devices, such as printers. The square shape has slightly beveled corners on two ends and allows the connection of peripheral devices without running the risk of connecting two host computers to one another.

### Mini Connectors

The **USB Mini-A** and **USB Mini-B** connectors were developed to provide data and power for smaller devices. These are USB 2.0 capable and support USB On-The-Go – OTG, which allows mobile devices and other peripherals to act as a USB host.

### Micro Connectors

The **USB Micro-A** and **USB Micro-B** connectors, which are also USB 2.0 capable, replaced the Mini connectors. These are slimmer interfaces that easily integrate into thinner devices such as cellphones, GPS units, and digital cameras.

### USB-C

The **USB-C** connector has a reversible interface that can be plugged into USB 3.2 Gen 2 devices with either end. USB-C cables are able to carry USB 1.1, USB 2.0, USB 3.0, USB 3.1 signals and pair with legacy USB connectors.  
  
With enough power for laptops, Type-C connectors are used for more than just data transfer. The bidirectional power capability allows host devices to charge peripheral devices, and vice versa, consolidating data transfer and power into one port.

![](https://i.imgur.com/B9Alhu9.png)

## Thunderbolt

**Thunderbolt 3** provides a super-set solution that defines the capabilities for USB-C cables. Since Thunderbolt 3 cables can work as USB-C Cables, both can use the same universal port type. Although the ports and interfaces look the same, there are notable differences.

Thunderbolt 3 has significantly better performance, operating at 40 Gbps, while USB-C functions at 20 Gbps. This means Thunderbolt 3 can present video on two 4K displays or one 5K screen, while USB-C is limited to a single 4K display.

Hosts, devices, and cables that are marked with the "lightning bolt" symbol are certified Thunderbolt devices. Licensed USB-C cables, connectors, and ports are marked with the SuperSpeed USB logo.

## Alternate Mode

**Alternate Mode** dedicates some of the physical wires in the USB-C cable to transmit other non-USB signals for audio and video data such as DisplayPort. These protocols can use the USB-C Cable to take advantage of the four high-speed data lanes to provide 4K resolution via Alt Mode.

## What does USB4 Offer?

The release of USB4 improves the ability to manage and allocate video resources, resulting in higher performance and reduced latency. Based on Thunderbolt 3 technology, the USB4 architecture enables two lane operation for transfer speeds of 40 Gbps throughput, and supports compatibility with USB 2.0, USB 3.2, and Thunderbolt 3 devices.

![](https://i.imgur.com/xvBQtUP.png)

## Maximum Cable Distances

While USB cables are quite versatile, they do have limitations. The primary disadvantage of the USB cable is its restricted maximum length for a connection. 

USB 1.0 Low-Speed devices have specifications for cable lengths that are limited to 3 meters (9 ft 10 in). In Full-Speed and High-Speed devices, the maximum cable length for USB 2.0 is 5 meters (16ft 5 in).

The USB 3.0 and USB 3.1 standards do not specify a maximum cable length between SuperSpeed+ devices but do not recommend a maximum practical length of 3 meters (9ft). Cable length for USB 3.2 should be limited to 2 meters for Gen 1 and 1 meter for Gen 2.

Reverting to the Thunderbolt 3 protocol for USB-C cables, the maximum length for passive cables is .5 meters (1 ft 6 in). Active cable lengths are limited to 2 meters (6’6”).  
[Extron USB Extenders](https://www.extron.com/product/listbytype.aspx?subtype=385) enable USB signal extension over twisted pair and fiber optic cable and Ethernet networks.

|Cable Type|Distance|
|---|---|
|USB 1.0|3m (9’10”)|
|USB 2.0|5m (16’5”)|
|USB 3.0|3m (9’10”)|
|USB 3.1|3m (9’10”)|
|USB 3.2 Gen 1|2m (6’6”)|
|USB 3.2 Gen 2|1m (3’3”)|
|USB4|.5m (1’6”) Passive  <br>2m (6’6”) Active|
## Power Supply and Charging

In addition to providing device communications, USB is a convenient source for powering mobile devices such as tablets and smartphones. For USB 1.0 and 2.0, a standard downstream port is capable of delivering up to 2.5 Watts of power. With USB 3.0 and 3.1, it moves up to 4.5 Watts. USB Battery Charging ports can supply up to 25 Watts to devices.

**USB Power Delivery - UPD** is a changing technology that provides up to 100 Watts of power when used with USB-C cables. UPD allows for power to flow in both directions, enabling either the host or peripheral devices to deliver power. 

**Sleep and Charge**: ports from a powered-down computer remain active and are still able to charge devices.

![](https://i.imgur.com/2020Jgq.png)

# USB Communications

The USB host is a hardware chipset with software drivers responsible for detecting the attachment and removal of USB devices. When a USB device is first connected to a USB host, the following process for device startup is performed:

- Enumeration begins once physical connection is detected.
- It is determined if the device will provide power or receive power
- A reset signal is sent to the device
- The appropriate data rate supported by the device is determined
- A unique numerical address is assigned to the device.
- Device drivers needed for communicating are loaded.
- The device is set to a configured state.
- Data flow is then managed between host and service.

**USB Enumeration**: is the discovery process of detecting, identifying, and loading drivers for a USB device.

![](https://i.imgur.com/y73fmpi.png)

## Communication Pipes

USB device communication is based on logical channels called pipes. A pipe is a connection from the host controller to a logical entity within a device called an endpoint. 

- **Stream Pipe**: Does not use a defined USB format for unidirectional data flow
- **Message Pipe**: Uses a defined USB format for bidirectional data flow

Each USB device can have up to 32 endpoint addresses (16 in and 16 out) assigned during the enumeration process.

![](https://i.imgur.com/ACA7OUo.png)

## Data Transfers

To manage data transfers efficiently, each pipe can support one of four types of transfers:

- **Control**: uses the control pipe for commands, status inquiries, and configuring the device. A **Default Control Pipe** is set up at endpoint zero so the device can communicate with the host controller.
- **Bulk**: Uses a data pipe for large data transfers and all the available bandwidth with no guarantee on transfer speed or latency.
- **Interrupt**: Uses a data pipe for sending small amounts of data for devices that require a guaranteed minimum latency and quick responses such as pointing devices, mice and keyboards.
- **Isochronous**: Uses a data pipe for time-critical applicatios requiring guaranteed delivery rates and predictable latency.

![](https://i.imgur.com/pXGmhdH.png)

## Data Packets

In terms of USB technology, packets are used as the basic unit of data transfer and communication:

- Token packets
- Data packets
- Handshake packets
- Special packets

Most USB transactions begin with a token packet sent from the host controller to a device on the bus. The packet describes the type and direction of transfer that should occur. Once the device decodes the token packet, it then either sends or receives data packets to or from the host controller. The receiving device sends a handshaking acknowledgement packet to complete the transaction.

![](https://i.imgur.com/XFMam5q.png)

## Tiered Star Topology

USB devices are interconnected in a star topology of no more than seven tiers for communication. With the host controller being at the top, Tier 1, the furthest possible peripheral device is at Tier 7. That leaves five tiers in between that can be occupied by hubs daisy-chained from one another to regenerate the USB signals.

The time required for the host controller to poll the bus and all electrical signals to pass to the furthest peripheral can be limiting over USB cable. So when designing USB distribution or extension systems, it is important to understand the limits on the number of hosts, hub and how peripherals are connected to the bus. 

![](https://i.imgur.com/yCD6LAz.png)

## USB Hubs

A USB hub device has one input port sharing bandwidth among all devices connected to multiple output ports. It consists of a:

- **Hub repeater**: Connects the upstream facing port and multiple downstream facing ports
- **Transaction Translator**: Converts between the different port speeds.
- **Hub Controller**: Communicates with the host controller to provide status and control information.

![](https://i.imgur.com/b77xD4g.png)

## Compound and Composite Devices

A USB device can be either a compound device or a composite device.

- **Compound** devices have peripherals and a hub enclosed in one package. For example, a keyboard and trackpad in one enclosure with one USB cable.
- **Composite** devices have multiple functions within the device, but has only one address. For example, a webcam with video and audio functions in one device. 

![](https://i.imgur.com/aQZICfk.png)

## Cascading Hub Limit

When building a USB extension or distribution system:

- Calculate the total number of hubs
- Ensure the bus will support all connected peripherals
- Confirm the bust does not exceed the five cascading hub limit

To determine the total number of cascading hubs in a USB topology, count all of the hubs between the host controller and the farthest peripheral. This includes all of the hubs located inside any computer connected to the bus, plus all hubs enclosed within USB compound devices.

Exceeding the max number of hubs could affect more than just the devices beyond the 5th hub. Any device on the bus would not be guaranteed to work reliably. 

![](https://i.imgur.com/X78n7zQ.png)

![](https://i.imgur.com/f1azaiz.png)

# USB in AV Systems

With the existence of USB ports on so many electronic devices, there has been a proliferation of USB devices being used in professional AV applications. This has created a sharp rise in the need for professional grade USB products such as *extenders*, *switchers*, *and connectivity devices*.

For example, this USB solution provides a scalable distribution and switching systems for many types of rooms. The matrix controller manages the CATx cabling system to extend USB keyboard, mouse, and storage capabilities to multiple devices.

![](https://i.imgur.com/es79v1c.png)

## USB for Pro AV

There are several points to consider when integrating USB-C in an AV system.

USB-C Operations - To support USB-C, it is important to understand what USB-C features will be used. USB-C devices can support all four or a combination of the following:

- **Data**: Low/High/Full Speed and SuperSpeed 5/10/20 Gbps
- **Video**: Alt mode, HDMI, DisplayPort, DisplayLink
- **Audio**: Alt Mode, HDMI, DisplayPort
- **Power**: Battery power and/or charging power

Ensure all devices and cables that connect via USB-C can support it. Or, if the AV device does not support these features, two USB-C cables may be required.

**Direct Cable Runs** - Since USB-C cables are not able to daisy-chain continuously through passive and active interfaces, plan for direct runs from the source device to a hub or switcher. As noted earlier, cascading USB signals through more than five active hubs may not work.

![](https://i.imgur.com/WHdF6l7.png)

## USB Extenders

[Extron USB Extenders](https://www.extron.com/product/listbytype.aspx?subtype=385) allow peripheral devices to be remotely located away from the host computer and enable USB signal extension over CATx cable using twisted pair transmitters and receivers. Extron fiber optic transmitters and receivers extend USB signals up to 30 km (18.75 miles).  
  
Extenders manipulate the signal timing of USB data for the extender transmitters and receivers to exchange information over Ethernet, or other high-speed protocol.  
  
Normally, extender sets require at least one or two hubs to be used within the transmitter for emulation and “keep alive” functions. For an extender receiver containing a multiport USB hub, another hub will be used in the receiver.

## USB Switchers

As the AV industry evolves, the need to reliably switch USB signals between multiple host devices and various peripherals continues to grow.   
  
When host controllers switch between busses and keyboard and mouse devices, switching can be slow if the USB bus has all devices enumerate each time a switch change occurs. For this reason, Extron USB switchers feature a host and peripheral emulation mode that provides a “keep alive” function on the USB ports. Once the switch connects to that peripheral again, enumeration and USB driver loading is not needed, so total switching time and chance of failed device communication is reduced.  
  
[Extron USB Switchers](https://www.extron.com/product/listbytype.aspx?subtype=306) are backward-compatible with all previous USB data rate specifications. The Pro Series switchers facilitate USB 3.2 for USB C and Thunderbolt with data rates up to 10 Gbps and control via RS 232 or Ethernet.

## USB Hubs

[Extron USB Hubs](https://www.extron.com/product/listbytype.aspx?subtype=308) are available in wall mount and furniture mount units, along with architectural adapter frames that can be installed in floor boxes. These form factors expand the number of devices that can communicate with the host. The one input port is able to share bandwidth among all devices connected to the output ports.

It consists of a:

- Hub controller – Provides status and control information to the host controller
- Hub repeater – Connects the upstream facing port and multiple downstream facing ports
- Transaction translator – Converts between the different port speeds

Hubs can be self-powered with optional 12VDC power supply or bus-powered by the host. Attached devices can draw power from the bus, but any device needing more power must be externally powered.

## AV to USB

[Extron HDMI to USB Bridge](https://www.extron.com/product/listbytype.aspx?subtype=656) converts traditional Pro AV sources such as computers, document cameras, AV switchers, and other audio and video sources to USB for computer connection. The USB connection is used by the computer to connect devices for soft codec applications and unified communications systems such as Skype, WebEx, GoToMeeting, Join.me, and more.  
  
These systems make it easy to integrate Pro AV systems in collaboration spaces where unified communications are common for remote collaboration and meetings.

## USB-C to MIDI

The Extron [USB‑C HD 101](https://www.extron.com/product/usbchd101) interface connects USB‑C sources to AV systems with HDMI inputs. It supports video resolutions up to 4K/60 and the Alt Mode capability from USB‑C also connects to DisplayPort interfaces. The internal Extron Everlast power supply uses USB Power Delivery to provide up to 60 watts of power and charging capabilities to the USB‑C source device, such as a laptop.  
  
This single connection for video and power provides an easy way to add USB‑C devices to an existing AV system with HDMI connections.

## USB Cables and Adapters

[Extron USBC](https://www.extron.com/product/usbc) and [Extron USBC-A](https://www.extron.com/product/usbca) are USB 3.1 cables that support data transfer speeds of up to 5 Gbps and are capable of delivering up to 60 watts of power for the USBC and 15 watts for the USBC-A.  
  
[Extron USBC-HD](https://www.extron.com/product/usbchd) and [USBC-DP](https://www.extron.com/product/usbcdp) are USB Type-C adapter cables for 4K video resolutions for integrating USB Type-C equipped sources that support DisplayPort Alternate Mode into new or existing HDMI or DisplayPort AV systems. Note that these cables do not convert from HDMI to DisplayPort nor DisplayPort to HDMI.

## Architectural Connectivity

[Extron USB AV Connectivity](https://www.extron.com/AV-Connectivity/prodtype-20) devices enable convenient, flexible USB integration into common AV environments with the following frames and enclosures:

- AV Connectivity Modules are mountable metal plates with various AV and USB pass-through connectors
- AVEdge cable access enclosure
- Cable Cubby Series furniture-mountable access enclosures
- HSA - Hideaway Surface Access enclosures
- Floor boxes

[Extron Retractor Modules](https://www.extron.com/product/listbytype.aspx?id=584&subtype=587#584) – Cable systems that provide retraction at the press of a button and adjustable speed control for smooth operation in both horizontal and vertical mounting.

- [Retractor Series](https://www.extron.com/product/retractorseries2?subtype=587) – Cable system for AVEdge 100, Cable Cubby Series, select TouchLink enclosures, and TMK 120 R Table Mount Kit for extension up to three feet (90 cm)
    
- [Retractor Series XL](https://www.extron.com/product/retractorseries2xl?subtype=587) – Cable system for AVEdge 100, Cable Cubby Series, select TouchLink enclosures, and TMK 120 R Table Mount Kit for extension up to five feet (152 cm)

## USB PowerPlate

[Extron USB PowerPlate](https://www.extron.com/product/listbytype.aspx?subtype=569) provides a 5 VDC, 2.1 A / 10.5 watt USB power source for charging mobile devices such as smartphones and tablets. The USB PowerPlate is available with USB form factors for power outlets in the AAP AV and MAAP Mini AV Connectivity Modules for ease of integration into any environment.

## USB Implementers Forum

[USB Implementers Forum – USB-IF](https://www.usb.org/) is a non-profit corporation founded by the companies that developed the USB specification. The USB-IF was formed to provide a support organization and forum for the advancement and adoption of Universal Serial Bus technology.

The Forum facilitates the development of high-quality compatible USB peripheral devices, and promotes the benefits of USB and the quality of products that have passed compliance testing.

